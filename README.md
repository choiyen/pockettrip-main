# 포켓 트립 (Pocket Trip)
**포켓 트립** 은 공동으로 경비를 관리하는 여행 비용 관리 웹 어플리케이션 입니다. 

<img width="1901" alt="스크린샷 2025-02-24 오후 3 50 50" src="https://github.com/user-attachments/assets/18cc1efe-b846-456c-b5e9-f951e62dd468" />



## 🛠️ 사용한 기술 스택

### 프론트엔드
<img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black"> <img src="https://img.shields.io/badge/typescript-3178C6?style=for-the-badge&logo=typescript&logoColor=white"> 
### 백엔드
<img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white"> <img src="https://img.shields.io/badge/mongodb-47A248?style=for-the-badge&logo=mongodb&logoColor=white"> 
### 배포
<img src="https://img.shields.io/badge/amazonec2-FF9900?style=for-the-badge&logo=amazonec2&logoColor=white"> <img src="https://img.shields.io/badge/pm2-2B037A?style=for-the-badge&logo=pm2&logoColor=white"> <img src="https://img.shields.io/badge/filezilla-BF0000?style=for-the-badge&logo=filezilla&logoColor=white">

### 디자인
<img src="https://img.shields.io/badge/figma-F24E1E?style=for-the-badge&logo=figma&logoColor=white">

---

## 📅 프로젝트 개요
- **기간**: 2025년 01월 16일 ~ 2025년 02월 20일
- **팀 프로젝트** (프론트엔드 2명 + 백엔드 2명)
- **개인 기여도**: **소켓 서버와 백엔드 서버 간 연결**, **프론트엔드와 백엔드 서버의 소켓 cols 문제 해결**, **JWT 백엔드 인증**, **소켓 연결 시 인증 문제 해결**, **AWS S3 스프링부트 연결**, **환율은행 API, Spring boot 스케줄러를 활용한 하루에 한번 5시마다 정보 가져오는 로직 개발**, **MongoDB를 이용한 데이터베이스 설계**

---

## 🔍 프로젝트를 시작하게 된 계기
프로젝트를 시작할 당시 가계부를 활용한 **비용 관리**에 대해 고민했습니다.<br/>
그러나 기존 앱들과 비교 분석한 결과, **은행과의 연동성** 측면에서 경쟁력이 다소 부족하다는 **한계**를 발견했습니다.<br/>
이에 대한 해결책으로, **여행과 결합**한 새로운 접근 방식을 시도했습니다.<br/>
그 결과, 여러 사용자가 **소켓을 통해 실시간으로 공유**할 수 있는 **외화 가계부 애플리케이션**을 제작하게 되었습니다.

---

## 🎯 주요 타겟층 및 기대효과
### 타겟층
**여럿이 함께 해외여행을 떠나는 여행객**<br/>
→ 공동 경비를 효율적으로 관리하고 싶은 사용자<br/>

**외화를 고려하여 체계적인 가계부 작성이 필요한 사람**<br/>
→ 환율을 반영한 지출 관리가 필요한 사용자

### 기대효과
**공동 경비를 투명하고 원활하게 관리**<br/>
→ 실시간으로 정산 및 분배가 가능<br/>

**여행 중 소비 내역을 한눈에 파악 가능**<br/>
→ 개별 및 전체 지출을 직관적으로 확인

---

## 📋 주요 기능
### 1. 여행 기간별 소비금액 관리(개인 담당)
- 초대 코드 발급을 통한 유저 초대 기능
- 소켓을 통한 실시간 소비내역 공유

### 2. 다음 여행까지 남은 기간 확인(개인 담당)
- D-day 로직 구현을 통한 현재 여행 기준 다음 여행기간을 추적

### 3. 환율을 고려한 계산기 기능
- 금융 Open API데이터를 기반으로한 환율정보 기반 계산기
  
### 4. 유저 데이터 기반 인기 여행지 그래프(개인 담당)
- Cart.js를 활용한 1위부터 3위까지의 인기 여행지
---

## 🙋 개인 기여도
### 🎨 프론트엔드 개발 및 UI/UX 설계
- **백엔드 서버 개발**
- **Springboot security를 활용한 JWT를 통한 유저 인증 관리**
- **프론트엔드와 백엔드 서버 내 소켯 컨트롤러 간 소켓 연결 구현**
- **백엔드 서버 내 AES를 통한 대칭키 암호화 코드 관리**
- **백엔드 서버에서 여행 정보 관리 시 여행 코드 대소문자, 특수문자, 숫자 조합의 10자리 코드 생성**
- **Spring boot  scheduler를 사용해 무분별한 Open API 적용 방지**\\\\

  
---

## 💻 구체적인 구현 기능
### 1. Springboot security를 활용한 JWT를 통한 유저 인증 관리
- **로그인이 필요한 컨트롤러**만 JWT 인증을 받도록 설계
### 2. 프론트엔드와 백엔드 서버 내 소켯 컨트롤러 간 소켓 연결 구현
- **소켓 인증**을 받은 후 RestTemplate을 이용하여 백엔드 서버에 관련 정보를 가져와 프론트엔드로 발송하는 형태
- 소켓 서버에서 백엔드 서버로 보낼 때 JWT가 담긴 header가 넘어가지 않는 문제 수정
- 소켓 서버랑 백엔드 서버 간 통신에서 jwt 패킷의 유효성 검사를 실시하므로, 중복적인 인증 검사 방지
### 3. 백엔드 서버에서 Database 간 정보 저장 시 암호화 구현
- 미리 생성한 초대코드를 백엔드 서버에 그대로 넣지 않고 **AES 암호화**를 통해 간단한 보안 적용
- 프론트엔드로 파일을 보낼 때는 암호화된 코드를 그대로 보낸 뒤, 프론트에서 복호화를 수행함
- 프론트엔드에서 보내온 코드와 백엔드의 코드를 확인할 때엔 데이터베이스 내 여행 코드를 복호화하여 비교함
### 4. 백엔드 서버에서 여행 정보 관리 시 여행 코드 대소문자, 특수문자, 숫자 조합의 10자리 코드 생성
- Random 함수를 사용하여, 특정 필터링을 걸어 10자리의 여행 코드를 만들고 암호화를 진행한 후 데이터베이스 내 코드들과 비교해 다르면 추가 가능한 여행코드로 판별
### 5. Spring boot   scheduler를 사용해 무분별한 Open API 적용 방지
-  scheduler의 @scheduled 어노테이션을 활용하여, 시스템을 실행했을 때, 오후 6시가 넘었을 때 Open api 정보를 가져오도록 설계
-  공휴일에 open api가 갱신되지 않고 빈배열로 송출된다는 점을 고려하여, 토요일과 일요일에는 금요일의 환율 정보를 가져오도록 설계
-  가져온 환율 정보를 프론트엔드에서 UI에 띄우기 편하도록 가공하고, 누락된 데이터가 있을 경우, 제거한 뒤 hashmap에 저장하는 로직 설계
-  프론트엔드에서 정보를 요청할 때에는 hashmap을 그대로 전달하도록 설계됨
### 6. Spring boot cash의 활용
- cash를 활용하여, 특정 id나 전체 정보를 가져올 때 메모리 효율 향상
---

## 🧩 해결 과제
### 1. Open api의 https로 인한 인증 문제
- **문제**: Open API가 Template를 통한 api 요청 시 https여서 추가적인 인증서를 요구하는 문제가 발생함
- **해결**: Java 가상 머신 내에 외부에서 발급 받은 인증서를 추가해서 문제를 해결, 
- **성과**: http와 https인 Open API 간의 인증 차이에 대해 학습
### 2. 환율은행 Open API에서 공휴일엔 데이터가 누락되며, 오후 5시가 넘어야 갱신되는 문제 발생
- **문제** : 은행의 휴무일에는 환율 Open API가 갱신되지 않고 [] 배열로 송출됨
- **해결1** : Spring boot Scheduler를 활용하여, cron식을 활용해 백엔드 서버가 처음 실행되었을 때와 오후 5시를 초과하였을 때 오늘 날짜를 받아와서 토요일, 일요일에 따라 다른 로직을 수행하도록 함
- **해결2** : 정보를 가져오는데 실패하였을 경우, 5회 추가 실시하고 안되면 이전 날짜의 정보를 가져오고 5회 동안 가져오지 못할 시 기본값을 hashmap에 할당함
- **성과** : 메모리 과부화 문제에 대해 공부하는 계기가 되었다. 
### 3. 소켓 연결간 CORS 문제 발생
- **문제**: 프론트엔드의 소켓 요청이 403에러로 인해 거부당하는 문제
- **해결**: 프론트엔드 팀원과의 코드 리뷰 진행을 통해 **JWT 인증 문제**를 확인
- **성과**: JWT 사용법 숙달 및 소켓 코드 정상 작동 확인
- 
---

## 💭 작업 후기 및 피드백
스프링부트와 리액트의 연동을 통해서 백엔드와 프론트엔드간의 여러 시행착오들(cors문제, 데이터 불일치 문제 등)을 많이 겪을 수 있는 작업이었다. 
Sock JS를 활용하여, 프론트엔드와 중계 서버 간의 소켓을 연결하고, 중계 서버와 백엔드 서버 간의 연결 시에 Spring Security가 어떤 식으로 동작하는지 알게 되었다. 


### 아쉬운 점
- **컨텐츠의 추가 필요**: 가계부를 제외한 여행관련 컨텐츠를 더욱 추가하지 못한것이 아쉽다. 
- **PWA 기능의 추가**: 해외에서의 사용을 고려해 PWA 기능을 추가적으로 구현하지 못한것이 아쉽다.
- **백엔드에서의 데이터 조회 시 불필요한 정보** : 전체 정보를 가져올 때 프론트엔드에서 ui에 송출하지 않는 부분을 고려하지 않고 전체 정보를 가져오게 설계함
- **싱글톤 패턴의 적용 미흡** : 프로젝트 수행을 종료한 뒤, 코드 리펙토링 과정에서 발견한 게 아쉽다.

### 앞으로의 계획
프론트엔드 팀원과의 주기적인 소통을 통해서 PWA 기능 구현 및 최적화를 수행을 진행하고 있습니다. 

---

## 📬 문의
- **개발자:** [최연철](https://github.com/choiyen)
- **이메일:** yyy1459@naver.com
